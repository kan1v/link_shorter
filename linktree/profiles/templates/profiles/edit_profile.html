{% extends "main/base.html" %}
{% load static %}

{% block content %}
<div class="min-h-screen">
    
  <div class="max-w-4xl mx-auto py-10 px-4">
      <h1 class="text-3xl font-bold mb-6 text-center text-white">Редагування публічного профілю</h1>

      <form method="post" enctype="multipart/form-data" class="space-y-8 bg-white bg-opacity-80 rounded-xl p-6 shadow-lg">
          {% csrf_token %}

          <!-- User данные -->
          <div class="space-y-4">
              <h2 class="text-xl font-semibold">Основна інформація</h2>
              <div class="flex items-center space-x-6">
                  {% if request.user.public_profile.avatar %}
                      <img src="{{ request.user.public_profile.avatar.url }}" alt="Аватар"
                           class="w-20 h-20 rounded-full object-cover border">
                  {% else %}
                      <img src="{% static 'images/default-avatar.png' %}" alt="Аватар"
                           class="w-20 h-20 rounded-full object-cover border">
                  {% endif %}
                  <div class="space-y-1 w-full">
                      <div>{{ user_form.username.label_tag }} {{ user_form.username }}</div>
                      <div>{{ user_form.first_name.label_tag }} {{ user_form.first_name }}</div>
                      <div>{{ user_form.last_name.label_tag }} {{ user_form.last_name }}</div>
                      <div>{{ user_form.email.label_tag }} {{ user_form.email }}</div>
                  </div>
              </div>
          </div>

          <!-- PublicProfile данные -->
          <div class="space-y-4">
              <h2 class="text-xl font-semibold">Налаштування профілю</h2>
              <div>{{ profile_form.slug.label_tag }} {{ profile_form.slug }}</div>
              <div>{{ profile_form.background_color.label_tag }} {{ profile_form.background_color }}</div>
              <div>{{ profile_form.button_style.label_tag }} {{ profile_form.button_style }}</div>
              <div>
                  {{ profile_form.background.label_tag }} {{ profile_form.background }}
                  {% if request.user.public_profile.background %}
                      <p class="text-sm text-gray-700 mt-1">Поточний фон:</p>
                      <img src="{{ request.user.public_profile.background.url }}" alt="Background"
                           class="w-40 h-20 object-cover rounded-md mt-1">
                  {% endif %}
              </div>
          </div>

          <!-- Social Links -->
          <div class="space-y-4">
              <h2 class="text-xl font-semibold">Соцмережі</h2>
              {{ social_formset.management_form }}
              {% for form in social_formset %}
                  <div class="bg-gray-50 border rounded-xl p-4 shadow-sm space-y-2">
                      {{ form.id }}
                      <div>{{ form.name.label_tag }} {{ form.name }}</div>
                      <div>{{ form.url.label_tag }} {{ form.url }}</div>
                      <div>{{ form.DELETE }} <label>Видалити</label></div>
                  </div>
              {% endfor %}
              <p class="text-sm text-gray-500">Щоб додати більше соцмереж — збережіть форму, і зʼявиться нове поле.</p>
          </div>

          <!-- Custom Buttons -->
          <div class="space-y-4">
              <h2 class="text-xl font-semibold">Додаткові кнопки</h2>
              {{ button_formset.management_form }}
              {% for form in button_formset %}
                  <div class="bg-gray-50 border rounded-xl p-4 shadow-sm space-y-2">
                      {{ form.id }}
                      <div>{{ form.title.label_tag }} {{ form.title }}</div>
                      <div>{{ form.url.label_tag }} {{ form.url }}</div>
                      <div>{{ form.order.label_tag }} {{ form.order }}</div>
                      <div>{{ form.DELETE }} <label>Видалити</label></div>
                  </div>
              {% endfor %}
              <p class="text-sm text-gray-500">Щоб додати більше кнопок — збережіть форму, і зʼявиться нове поле.</p>
          </div>

          <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg w-full">Зберегти</button>
      </form>
  </div>
</div>
{% endblock %}
